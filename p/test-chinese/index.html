<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="è¿™æ˜¯ä¸€ä¸ªå‰¯æ ‡é¢˜"><title>Chinese Test</title><link rel=canonical href=https://example.com/p/test-chinese/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="Chinese Test"><meta property="og:description" content="è¿™æ˜¯ä¸€ä¸ªå‰¯æ ‡é¢˜"><meta property="og:url" content="https://example.com/p/test-chinese/"><meta property="og:site_name" content="sy"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2020-09-09T00:00:00+00:00"><meta property="article:modified_time" content="2020-09-09T00:00:00+00:00"><meta property="og:image" content="https://example.com/p/test-chinese/ICPC.png"><meta name=twitter:title content="Chinese Test"><meta name=twitter:description content="è¿™æ˜¯ä¸€ä¸ªå‰¯æ ‡é¢˜"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.com/p/test-chinese/ICPC.png"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/head_portrait_hu1368e4ffa06e7513186f849074288e92_335306_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>sy</a></h1><h2 class=site-description>æœ€æ˜¯äººé—´ç•™ä¸ä½ï¼Œæœ±é¢œè¾é•œèŠ±è¾æ ‘ã€‚</h2></div></header><ol class=social-menu><li><a href='https://github.com/clumsy-sy?tab=repositories' target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>ä¸»é¡µ</span></a></li><li><a href=/%E5%85%B3%E4%BA%8E/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>å…³äº</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>å½’æ¡£</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>æœç´¢</span></a></li><li><a href=/%E9%93%BE%E6%8E%A5/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>é“¾æ¥</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#å›¾ç‰‡>å›¾ç‰‡</a></li><li><a href=#å…¬å¼>å…¬å¼</a><ol><li><a href=#examples>Examples</a></li><li><a href=#examples-1>Examples</a></li></ol></li><li><a href=#è§†é¢‘é“¾æ¥æµ‹è¯•>è§†é¢‘é“¾æ¥æµ‹è¯•</a></li><li><a href=#youtube-privacy-enhanced-shortcode>YouTube Privacy Enhanced Shortcode</a></li><li><a href=#bilibilibi-shortcode>bilibilibi Shortcode</a></li><li><a href=#fft>FFT</a><ol><li><a href=#å¤šé¡¹å¼ä¹˜æ³•>å¤šé¡¹å¼ä¹˜æ³•</a></li><li><a href=#å•ä½åŸæ ¹>å•ä½åŸæ ¹</a></li><li><a href=#åˆ†æ²»>åˆ†æ²»</a></li><li><a href=#è´è¶å˜æ¢>è´è¶å˜æ¢</a></li></ol></li><li><a href=#ntt>NTT</a><ol><li><a href=#åŸæ ¹>åŸæ ¹</a></li><li><a href=#å¿«é€Ÿæ•°è®ºå˜æ¢>å¿«é€Ÿæ•°è®ºå˜æ¢</a></li></ol></li><li><a href=#çº¿æ€§å˜æ¢>çº¿æ€§å˜æ¢</a><ol><li><a href=#é¢„å¤„ç†å•ä½æ ¹>é¢„å¤„ç†å•ä½æ ¹</a></li></ol></li><li><a href=#tags-å¤šé¡¹å¼>author: &ldquo;rogeryoungh&rdquo;
title: &ldquo;FFT & NTT å­¦ä¹ ç¬”è®°&rdquo;
date: &ldquo;2021-07-22&rdquo;
description: &ldquo;FFT æ€ä¹ˆè¿™ä¹ˆéš¾å•Šã€‚&rdquo;
tags: [å¤šé¡¹å¼]</a></li><li><a href=#fft-1>FFT</a><ol><li><a href=#å¤šé¡¹å¼ä¹˜æ³•-1>å¤šé¡¹å¼ä¹˜æ³•</a></li><li><a href=#ç‚¹å€¼è¡¨ç¤ºæ³•>ç‚¹å€¼è¡¨ç¤ºæ³•</a></li><li><a href=#dft>DFT</a></li><li><a href=#å•ä½åŸæ ¹-1>å•ä½åŸæ ¹</a></li><li><a href=#åˆ†æ²»-1>åˆ†æ²»</a></li><li><a href=#è´è¶å˜æ¢-1>è´è¶å˜æ¢</a></li></ol></li><li><a href=#ntt-1>NTT</a><ol><li><a href=#åŸæ ¹-1>åŸæ ¹</a></li><li><a href=#å¿«é€Ÿæ•°è®ºå˜æ¢-1>å¿«é€Ÿæ•°è®ºå˜æ¢</a></li></ol></li><li><a href=#çº¿æ€§å˜æ¢-1>çº¿æ€§å˜æ¢</a><ol><li><a href=#å¹²æ‰-rev>å¹²æ‰ REV</a></li><li><a href=#å¦ä¸€ç§ç†è§£>å¦ä¸€ç§ç†è§£</a></li><li><a href=#original-fft>Original FFT</a></li><li><a href=#é¢„å¤„ç†å•ä½æ ¹-1>é¢„å¤„ç†å•ä½æ ¹</a></li><li><a href=#å…¶ä»–åº”ç”¨>å…¶ä»–åº”ç”¨</a></li></ol></li><li><a href=#refence>Refence</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/test-chinese/><img src=/p/test-chinese/ICPC_huac24b15fca495a3d437d2bd38e73db2d_4994_800x0_resize_box_3.png srcset="/p/test-chinese/ICPC_huac24b15fca495a3d437d2bd38e73db2d_4994_800x0_resize_box_3.png 800w, /p/test-chinese/ICPC_huac24b15fca495a3d437d2bd38e73db2d_4994_1600x0_resize_box_3.png 1600w" width=800 height=321 loading=lazy alt="Featured image of post Chinese Test"></a></div><div class=article-details><header class=article-category><a href=/categories/test/ style=background-color:#2a9d8f;color:#fff>Test</a>
<a href=/categories/acm-icpc/ style=background-color:orange;color:#fff>ACM-ICPC</a>
<a href=/categories/math/ style=background-color:#00bfff;color:#fff>Math</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/test-chinese/>Chinese Test</a></h2><h3 class=article-subtitle>è¿™æ˜¯ä¸€ä¸ªå‰¯æ ‡é¢˜</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Sep 09, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 18 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=å›¾ç‰‡>å›¾ç‰‡</h2><p><img src=/p/test-chinese/ICPC.png width=354 height=142 srcset="/p/test-chinese/ICPC_huac24b15fca495a3d437d2bd38e73db2d_4994_480x0_resize_box_3.png 480w, /p/test-chinese/ICPC_huac24b15fca495a3d437d2bd38e73db2d_4994_1024x0_resize_box_3.png 1024w" loading=lazy alt=ICPC class=gallery-image data-flex-grow=249 data-flex-basis=598px></p><h2 id=å…¬å¼>å…¬å¼</h2><p>Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.</p><p>In this example we will be using <a class=link href=https://katex.org/ target=_blank rel=noopener>KaTeX</a></p><ul><li>Create a partial under <code>/layouts/partials/math.html</code></li><li>Within this partial reference the <a class=link href=https://katex.org/docs/autorender.html target=_blank rel=noopener>Auto-render Extension</a> or host these scripts locally.</li><li>Include the partial in your templates like so:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{{</span> <span class=k>if</span> or .Params.math .Site.Params.math <span class=o>}}</span>
</span></span><span class=line><span class=cl><span class=o>{{</span> partial <span class=s2>&#34;math.html&#34;</span> . <span class=o>}}</span>
</span></span><span class=line><span class=cl><span class=o>{{</span> end <span class=o>}}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>To enable KaTex globally set the parameter <code>math</code> to <code>true</code> in a project&rsquo;s configuration</li><li>To enable KaTex on a per page basis include the parameter <code>math: true</code> in content files</li></ul><p><strong>Note:</strong> Use the online reference of <a class=link href=https://katex.org/docs/supported.html target=_blank rel=noopener>Supported TeX Functions</a></p><h3 id=examples>Examples</h3><p>Block math:
$$
\varphi = 1+\frac{1} {1+\frac{1} {1+\frac{1} {1+\cdots} } }
$$</p><p>Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.</p><p>In this example we will be using <a class=link href=https://katex.org/ target=_blank rel=noopener>KaTeX</a></p><ul><li>Create a partial under <code>/layouts/partials/math.html</code></li><li>Within this partial reference the <a class=link href=https://katex.org/docs/autorender.html target=_blank rel=noopener>Auto-render Extension</a> or host these scripts locally.</li><li>Include the partial in your templates like so:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{{</span> <span class=k>if</span> or .Params.math .Site.Params.math <span class=o>}}</span>
</span></span><span class=line><span class=cl><span class=o>{{</span> partial <span class=s2>&#34;math.html&#34;</span> . <span class=o>}}</span>
</span></span><span class=line><span class=cl><span class=o>{{</span> end <span class=o>}}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>To enable KaTex globally set the parameter <code>math</code> to <code>true</code> in a project&rsquo;s configuration</li><li>To enable KaTex on a per page basis include the parameter <code>math: true</code> in content files</li></ul><p><strong>Note:</strong> Use the online reference of <a class=link href=https://katex.org/docs/supported.html target=_blank rel=noopener>Supported TeX Functions</a></p><h3 id=examples-1>Examples</h3><p>Block math:
$$
\varphi = 1+\frac{1} {1+\frac{1} {1+\frac{1} {1+\cdots} } }
$$</p><h2 id=è§†é¢‘é“¾æ¥æµ‹è¯•>è§†é¢‘é“¾æ¥æµ‹è¯•</h2><p>Hugo ships with several <a class=link href=https://gohugo.io/content-management/shortcodes/#use-hugo-s-built-in-shortcodes target=_blank rel=noopener>Built-in Shortcodes</a> for rich content, along with a <a class=link href=https://gohugo.io/about/hugo-and-gdpr/ target=_blank rel=noopener>Privacy Config</a> and a set of Simple Shortcodes that enable static and no-JS versions of various social media embeds.</p><hr><h2 id=youtube-privacy-enhanced-shortcode>YouTube Privacy Enhanced Shortcode</h2><div class=video-wrapper><iframe loading=lazy src=https://www.youtube.com/embed/ZJthWmvUzzc allowfullscreen title="YouTube Video"></iframe></div><hr><h2 id=bilibilibi-shortcode>bilibilibi Shortcode</h2><div class=video-wrapper><iframe src="https://player.bilibili.com/player.html?as_wide=1&high_quality=1&page=1&aid=498363026" scrolling=no frameborder=no framespacing=0 allowfullscreen></iframe></div><h2 id=fft>FFT</h2><p>ä»¥ä¸‹è®²è¿°çš„ç®—æ³•æ˜¯ Cooleyâ€“Tukey FFTï¼Œå®ƒåœ¨ç®—æ³•ç«èµ›ä¸­ä½¿ç”¨çš„æ›´ä¸ºå¹¿æ³›ã€‚</p><p>å‰ç½®çŸ¥è¯†ï¼šå¤æ•°ï¼Œéœ€è¦ç†è§£ Euler å…¬å¼ã€‚</p><h3 id=å¤šé¡¹å¼ä¹˜æ³•>å¤šé¡¹å¼ä¹˜æ³•</h3><p>å¯¹äº $n$ æ¬¡å¤šé¡¹å¼</p><p>$$
\begin{aligned}
f(x) = \sum_{i=0}^n f_ix^i &= f_0 + f_1 x + f_2x^2 + \cdots + g_nx^n \\
g(x) = \sum_{i=0}^n g_ix^i &= g_0 + g_1 x + g_2x^2 + \cdots + g_nx^n
\end{aligned}
$$</p><p>å®ƒä»¬çš„å·ç§¯æ˜¯ $F(x) = f(x) \ast g(x) = (f \ast g)(x) = \sum\limits_{k=0}^{2n} c_kx^k$ï¼Œå…¶ä¸­</p><p>$$
c_k = \sum_{i+j=k}f_ig_j
$$</p><p>å› æ­¤æœ´ç´ çš„è®¡ç®—å¤šé¡¹å¼çš„å·ç§¯éœ€è¦ $n^2$ æ¬¡ç³»æ•°ä¹˜æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚</p><h3 id=å•ä½åŸæ ¹>å•ä½åŸæ ¹</h3><p>è‡³æ­¤ï¼Œæˆ‘ä»¬è®¡ç®— DFT çš„å¤æ‚åº¦ä»ç„¶æ˜¯ $O(n^2)$ï¼ŒFFT æ‰€è¿ˆå‡ºçš„å…³é”®ä¸€æ­¥æ˜¯é€‰å–ç‰¹æ®Šçš„ç‚¹åŠ é€Ÿè®¡ç®—ã€‚</p><p>å•ä½æ ¹ä¸­ç‰¹æ®Šçš„ä¸€ä¸ªè®°ä½œ $\zeta_n = e^{\frac{2 \pi i}{n}}$ï¼Œå®ƒå«åšå•ä½åŸæ ¹ã€‚ä¾ Euler å…¬å¼ï¼Œæœ‰</p><p>$$
\zeta_n = e^{\tfrac{2 \pi i}{n}} = \cos \left(\frac{2\pi}{n}\right) + i \sin \left(\frac{2\pi}{n}\right)
$$</p><p>å³ $\zeta_n$ æ˜¯å•ä½åœ†ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œå…¨éƒ¨çš„ $n$ ä¸ªå•ä½æ ¹</p><p>$$
x_k = \zeta_n^k = e^{k\tfrac{2 \pi i}{n}} = \cos \left(\frac{2\pi k}{n}\right) + i \sin \left(\frac{2\pi k}{n}\right)
$$</p><p>æ°å¯¹åº”åˆ°å•ä½åœ†çš„ $n$ ç­‰åˆ†ç‚¹ã€‚å› æ­¤æ ¹æ® Euler å…¬å¼ï¼Œ<strong>å•ä½æ ¹ä¹‹é—´çš„ä¹˜æ³•å°±æ˜¯åœ¨å•ä½åœ†ä¸Šè½¬åœˆåœˆã€‚</strong></p><p>ä¸éš¾é€šè¿‡ Euler å…¬å¼éªŒè¯å•ä½åŸæ ¹ $\zeta_n$ çš„å‡ æ¡æ€§è´¨ï¼š</p><ul><li>$\zeta_{2n}^{2k} = \zeta_n^k$ã€‚</li><li>$\zeta_{2n}^{n+k} = -\zeta_{2n}^k$ã€‚</li></ul><h3 id=åˆ†æ²»>åˆ†æ²»</h3><p>åˆ©ç”¨å•ä½åŸæ ¹çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ²»è®¡ç®— DFTã€‚æ¯”å¦‚å¯¹äº $7$ æ¬¡å¤šé¡¹å¼</p><p>$$
\begin{aligned}
f(x) &= f_0 + f_1x + f_2x^2 + f_3 x^3 + f_4 x^4 + f_5 x^5 + f_6 x^6 + f_7 x^7 \
&= (f_0 + f_2x^2 + f_4x^4 + f_6x^6) + x(f_1 + f_3x^2 + f_5x^4 + f_7x^6)
\end{aligned}
$$</p><p>å¥‡å¶åˆ†ç±»</p><p>$$
\begin{aligned}
f^{[0]}(x) &= f_0 + f_2x + f_4x^2 + f_6x^3 \
f^{[1]}(x) &= f_1 + f_3x + f_5x^2 + f_7x^3
\end{aligned}
$$</p><p>åˆ™åŸæ¥çš„å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸º</p><p>$$
f(x) = f^{[0]}(x^2) + xf^{[1]}(x^2)
$$</p><p>ä¸€èˆ¬çš„ï¼Œå¯¹äºåº¦å°äº $n$ çš„å¤šé¡¹å¼ $f(x)$ï¼Œåœ¨å•ä½æ ¹ $x = \zeta_n^k$ å¤„çš„ç‚¹å€¼æ˜¯</p><p>$$
\begin{aligned}
f(\zeta_n^k) &= f^{[0]}(\zeta_n^k \cdot \zeta_n^k) + \zeta_n^kf^{[1]}(\zeta_n^k \cdot \zeta_n^k) \\
&= f^{[0]}(\zeta_n^{2k}) + \zeta_n^kf^{[1]}(\zeta_n^{2k}) \\
&= f^{[0]}(\zeta_{n/2}^{k}) + \zeta_n^kf^{[1]}(\zeta_{n/2}^{k})
\end{aligned}
$$</p><p>åŒç†å¯å¾—</p><p>$$
\begin{aligned}
f(\zeta_n^{k+n/2}) &= f^{[0]}(\zeta_n^{2k+n}) + \zeta_n^{k+n/2}f^{[1]}(\zeta_n^{2k+n}) \
&= f^{[0]}(\zeta_{n/2}^{k}) - \zeta_n^{k}f^{[1]}(\zeta_{n/2}^{k})
\end{aligned}
$$</p><p>åœ¨ DFT ä¸­ä½¿ç”¨æœ‰</p><p>$$
\begin{aligned}
\mathcal{F}<em>n(f)[j] &= \mathcal{F}</em>{n/2}(f^{[0]})[j] + \zeta_n^j \mathcal{F}<em>{n/2}(f^{[1]})[j] \
\mathcal{F}<em>n(f)[j + n/2] &= \mathcal{F}</em>{n/2}(f^{[0]})[j] - \zeta_n^j\mathcal{F}</em>{n/2}(f^{[1]})[j]
\end{aligned}
\tag{2}
$$</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦æŠŠå¤šé¡¹å¼çš„ç³»æ•°ä¸ªæ•°å‘ä¸Šè¡¥åˆ° $2^n$ï¼Œæ–¹ä¾¿åˆ†æ²»ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºé€’å½’ç‰ˆçš„ FFTã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>op</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>img</span> <span class=n>tmp</span><span class=p>[</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>18</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>  <span class=c1>// å¶æ•°æ”¾å·¦è¾¹ï¼Œå¥‡æ•°æ”¾å³è¾¹
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>i</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>*</span><span class=n>g</span> <span class=o>=</span> <span class=n>f</span><span class=p>,</span> <span class=o>*</span><span class=n>h</span> <span class=o>=</span> <span class=n>f</span> <span class=o>+</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fft</span><span class=p>(</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>op</span><span class=p>),</span> <span class=n>fft</span><span class=p>(</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>h</span><span class=p>,</span> <span class=n>op</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>PI</span> <span class=o>/</span> <span class=n>n</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>PI</span> <span class=o>*</span> <span class=n>op</span> <span class=o>/</span> <span class=n>n</span><span class=p>)},</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=n>w</span> <span class=o>*</span> <span class=n>h</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=n>w</span> <span class=o>*</span> <span class=n>h</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è´è¶å˜æ¢>è´è¶å˜æ¢</h3><p>é€’å½’åˆ†æ²»æ€»æ˜¯ä¸å°½äººæ„çš„ï¼Œæˆ‘ä»¬åœ¨å‰å‡ è¡Œåªæ˜¯åšäº†é€’å½’åˆ†ç»„çš„äº‹æƒ…ï¼Œå¯ä»¥è€ƒè™‘ä¸€æ­¥åˆ°ä½ã€‚</p><p>è¿˜æ˜¯ä»¥ $7$ æ¬¡å¤šé¡¹å¼ä¸ºä¾‹</p><ul><li>åˆå§‹ ${x^0,x^1,x^2,x^3,x^4,x^5,x^6,x^7}$</li><li>ä¸€æ¬¡ ${x^0,x^2,x^4,x^6},{x^1,x^3,x^5,x^7}$</li><li>ä¸¤æ¬¡ ${x^0,x^4},{x^2,x^6},{x^1,x^5},{x^3,x^7}$</li><li>ç»“æŸ ${x^0},{x^4},{x^2},{x^6},{x^1},{x^5},{x^3},{x^7}$</li></ul><p>å†™å‡ºäºŒè¿›åˆ¶çš„å½¢å¼ï¼Œå¯ä»¥å‘ç°ï¼šç»“æŸå’Œå¼€å§‹çš„äºŒè¿›åˆ¶æ°å¥½æ˜¯ç›¸åçš„ã€‚</p><div class=table-wrapper><table><thead><tr><th style=text-align:center>åˆå§‹</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th></tr></thead><tbody><tr><td style=text-align:center>åˆå§‹(2)</td><td style=text-align:center>000</td><td style=text-align:center>001</td><td style=text-align:center>010</td><td style=text-align:center>011</td><td style=text-align:center>100</td><td style=text-align:center>101</td><td style=text-align:center>110</td><td style=text-align:center>111</td></tr><tr><td style=text-align:center>ç»“æŸ(2)</td><td style=text-align:center>000</td><td style=text-align:center>100</td><td style=text-align:center>010</td><td style=text-align:center>110</td><td style=text-align:center>001</td><td style=text-align:center>101</td><td style=text-align:center>011</td><td style=text-align:center>111</td></tr><tr><td style=text-align:center>ç»“æŸ</td><td style=text-align:center>0</td><td style=text-align:center>4</td><td style=text-align:center>2</td><td style=text-align:center>6</td><td style=text-align:center>1</td><td style=text-align:center>5</td><td style=text-align:center>3</td><td style=text-align:center>7</td></tr></tbody></table></div><p>è¿™ä¸ªå˜æ¢ç§°ä¸ºè´è¶å˜æ¢ï¼Œä¹Ÿç§°ä½é€†åºç½®æ¢ï¼ˆbit-reversal permutationï¼‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ $O(n)$ çš„é¢„å¤„ç†å‡ºå˜æ¢æ•°ç»„ã€‚è®¾ <code>R(x)</code> æ˜¯ $x$ çš„å˜æ¢ç»“æœï¼Œåˆ™ <code>R(x >> 1)</code> æ­¤æ—¶æ˜¯å·²çŸ¥çš„ã€‚å³æ˜¯æŠŠ <code>R(x >> 1)</code> å³ç§»ä¸€ä½å†è¡¥ä¸Šæœ€é«˜ä½å³å¯ã€‚ä»£ç å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>pre_rev</span><span class=p>(</span><span class=kt>int</span> <span class=n>lim</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>__lg</span><span class=p>(</span><span class=n>lim</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>rev</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>lim</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>lim</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>|=</span> <span class=n>lim</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æˆ–è€…åˆå¹¶å†™ä¸º
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (k - 1));
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™å‡ºéé€’å½’ç‰ˆçš„ FFTã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>op</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// DIT
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;=</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>*</span> <span class=n>op</span> <span class=o>/</span> <span class=n>l</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>l</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span> <span class=n>x</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>y</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ntt>NTT</h2><p>å‰ç½®çŸ¥è¯†ï¼šæ•°è®ºåŸºç¡€ï¼ˆæ•´é™¤ï¼ŒåŒä½™ï¼‰ã€‚</p><p>ç”¨ <code>double</code> å»å®ç°æ•´æ•°çš„ä¹˜æ³•æ˜¯å¾ˆä¸ä¼˜ç¾çš„ï¼Œç²¾åº¦ã€é€Ÿåº¦éƒ½å¾ˆæˆé—®é¢˜ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä»…åœ¨æ•´æ•°ä¸‹è¿›è¡Œè¿ç®—ã€‚</p><h3 id=åŸæ ¹>åŸæ ¹</h3><p>æˆ‘ä»¬æœ¬è´¨ä¸Šç”¨åˆ°çš„å•ä½åŸæ ¹ $\zeta_n$ çš„ä¸¤ä¸ªæ€§è´¨æ˜¯ï¼š</p><ul><li>$\zeta_{n}^{n} = 1$ã€‚</li><li>$\zeta_{2n}^{n} = -1$ã€‚</li></ul><p>å¯ä»¥è”æƒ³åˆ°æ¨¡ $p$ å‰©ä½™ç±»åŸŸ $\mathbb{Z}_p$ï¼šå…¶ä¸­çš„å…ƒç´ æ˜¯ ${0,1,\cdots,p-1}$ï¼Œå…¶ä¸Šçš„è¿ç®—éƒ½æ˜¯æ¨¡ $p$ çš„ã€‚ç”±äº Fermat å°å®šç†</p><p>$$
a^{\varphi(p)} = a^{p-1} \equiv 1
$$</p><p>å³ä»å¦ä¸€ä¸ªè§’åº¦è¯´ï¼Œ$p-1$ ä¸ªæ­£æ•´æ•°éƒ½æ˜¯åŒä½™æ–¹ç¨‹ $x^{p-1} \equiv 1$ çš„è§£ã€‚</p><p>å®ƒå’Œå•ä½æ ¹æœ‰å¾ˆç›¸ä¼¼çš„å½¢å¼ï¼Œç›´è§‰ä¸Š $\mathbb{Z}_p$ ä¹Ÿå­˜åœ¨ç±»ä¼¼å•ä½åŸæ ¹çš„ç‰¹æ®Šæ•°å­—ã€‚ä¸‹é¢æˆ‘ä»¬åœ¨ $\mathbb{Z}_p$ ä¸Šè®¨è®ºï¼Œå°è¯•è¯æ˜è¿™ä¸ªæ•°å­—å­˜åœ¨ã€‚</p><p>å®šä¹‰æ­£æ•´æ•° $a \in \mathbb{Z}_p$ çš„é˜¶ $\delta_p(a)$ ä¸ºæœ€å°çš„ $r$ ä½¿å¾— $a^r \equiv 1$ã€‚ç”± Fermat å°å®šç† $a^{\varphi(p)} \equiv 1$ï¼Œå› æ­¤ $a$ çš„é˜¶ä¸€å®šå­˜åœ¨ä¸”æœ‰ $\delta_p(a) \mid \varphi(p)$ã€‚å¯ä»¥è¯æ˜</p><p>$$
a,a^2,\cdots a^{\delta_p(a)} \tag{3}
$$</p><p>åœ¨æ¨¡ $p$ ä¸‹ä½™æ•°äº’ä¸ç›¸åŒã€‚ç”± Lagrange å®šç†ï¼Œ$x^{\delta_p(a)} \equiv 1$ çš„è§£è‡³å¤šæœ‰ $\delta_p(a)$ ä¸ªï¼Œæ°æ˜¯ $(3)$ ä¸­æ‰€å±•ç¤ºçš„ã€‚</p><p>é€šè¿‡æ•´é™¤çš„æ€§è´¨ï¼Œå¯ä»¥æƒ³åˆ°åªæœ‰ $i \bot \delta_p(a)$ æ‰æœ‰ $\delta_p(a^i) = \delta_p(a)$ï¼Œå³ $a$ æ€»æ˜¯é™„å¸¦ç€</p><p>$$
\sum_{i=1}^{\delta_p(a)} [\gcd(i, \delta_p(a)) = 1] = \varphi(\delta_p(a))
$$</p><p>ä¸ªé˜¶ç›¸åŒçš„ä¸œè¥¿ã€‚å› æ­¤é˜¶ä¸º $\delta_p(a)$ çš„æ•°æ°æœ‰ $\varphi(\delta_p(a))$ ä¸ªã€‚</p><p>å› ä¸ºæ¯ä¸ªæ­£æ•´æ•°éƒ½æœ‰å”¯ä¸€ç¡®å®šçš„é˜¶ï¼Œä¸å¦¨å‡è®¾å¯¹äºæ‰€æœ‰ $d \mid \varphi(p)$ï¼Œé˜¶ $d$ éƒ½å­˜åœ¨ $\varphi(d)$ ä¸ªå¯¹åº”çš„æ•´æ•°ï¼Œç»Ÿè®¡æ•´æ•°ä¸ªæ•°</p><p>$$
\sum_{d \mid \varphi(p)} \varphi(d) = \varphi(p) = p - 1
$$</p><p>æ°ä¸º $\mathbb{Z}_p$ å…¨éƒ¨æ­£æ•´æ•°çš„ä¸ªæ•°ï¼Œå› æ­¤å‡è®¾æˆç«‹ï¼Œä¹Ÿå°±å­˜åœ¨ $a$ ä½¿å¾— $\delta_p(a) = p-1$ã€‚</p><p>æˆ‘ä»¬ç§°è¿™ä¸ª $a$ æ˜¯æ¨¡ $p$ ä¸‹çš„ä¸€ä¸ªåŸæ ¹ï¼Œå¸¸ç”¨å­—æ¯ $g$ è¡¨ç¤ºã€‚</p><h3 id=å¿«é€Ÿæ•°è®ºå˜æ¢>å¿«é€Ÿæ•°è®ºå˜æ¢</h3><p>å°½å¯èƒ½æå– $p - 1$ çš„å› å­ $2$ æœ‰</p><p>$$
p = N q + 1, N = 2^m
$$</p><p>è®¾ $\mathbb{Z}_p$ çš„ä¸€ä¸ªåŸæ ¹ $g$ï¼Œå°† $g_N \equiv g^q$ çœ‹ä½œ $\zeta_n$ çš„ç­‰ä»·ã€‚åˆ©ç”¨äºŒæ¬¡å‰©ä½™çš„çŸ¥è¯†ä¸éš¾å¾—åˆ° $g_N^N \equiv 1$ å’Œ $g_N^{N/2} \equiv -1$ã€‚</p><p>å¸¸è§çš„æœ‰</p><p>$$
\begin{aligned}
p = 1004535809 = 479 \times 2^{21} + 1&, g = 3 \
p = 998244353 = 7 \times 17 \times 2^{23} + 1&, g = 3
\end{aligned}
$$</p><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºç¨‹åº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>ntt</span><span class=p>(</span><span class=n>ll</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>h</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span> <span class=n>h</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>h</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ll</span> <span class=n>tg</span> <span class=o>=</span> <span class=n>type</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=mi>3</span> <span class=o>:</span> <span class=n>g_inv</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>ll</span> <span class=n>gn</span> <span class=o>=</span> <span class=n>qpow</span><span class=p>(</span><span class=n>tg</span><span class=p>,</span> <span class=p>(</span><span class=n>P</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=n>h</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span> <span class=o>+=</span> <span class=n>h</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>ll</span> <span class=n>g</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>j</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>j</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ll</span> <span class=n>f1</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>f2</span> <span class=o>=</span> <span class=n>g</span> <span class=o>*</span> <span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>f1</span> <span class=o>+</span> <span class=n>f2</span><span class=p>)</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>f1</span> <span class=o>-</span> <span class=n>f2</span> <span class=o>+</span> <span class=n>P</span><span class=p>)</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>g</span> <span class=o>=</span> <span class=n>g</span> <span class=o>*</span> <span class=n>gn</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>iv_n</span> <span class=o>=</span> <span class=n>qpow</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>iv_n</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è‡³æ­¤ï¼Œä½ å·²ç»å­¦ä¼š FFT äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°†æ›´æ·±å…¥çš„ä»æ•°å­¦è§’åº¦ç ”ç©¶ FFTï¼Œè¡¥è¶³ç†è®ºåŸºç¡€ã€‚</p><h2 id=çº¿æ€§å˜æ¢>çº¿æ€§å˜æ¢</h2><p>DFT æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥è¢«å†™æˆçŸ©é˜µä¹˜æ³•çš„å½¢å¼</p><p>$$
\begin{bmatrix}
f(\zeta_n^0) \ f(\zeta_n^1) \ f(\zeta_n^2) \ \vdots \ f(\zeta_n^{n-1})
\end{bmatrix} = \begin{bmatrix}
1 & 1 & 1 & \cdots & 1 \
1 & \zeta_n^1 & \zeta_n^2 & \cdots & \zeta_n^{n-1} \
1 & \zeta_n^2 & \zeta_n^4 & \cdots & \zeta_n^{2(n-1)} \
\vdots & \vdots & \vdots & \ddots & \vdots \
1 & \zeta_n^{n-1} & \zeta_n^{2(n-1)} & \cdots & \zeta_n^{(n-1)^2}
\end{bmatrix}
\begin{bmatrix}
f_0 \ f_1 \ f_2 \ \vdots \ f_{n-1}
\end{bmatrix}
$$</p><p>æˆ‘ä»¬æŠŠä¸­é—´çš„é‚£ä¸ª $n$ é˜¶çš„ Vandermonde æ–¹é˜µè®°ä¸º $V(\zeta_n) = (\zeta_n^{ij})$ã€‚</p><p>ç›´æ¥è®¡ç®— $V(\zeta_n)$ çš„é€†å¾ˆä¸å¥½ç®—ï¼Œä½†æ˜¯éªŒè¯ä¸‹å¼æ˜¯å¯¹è§’çŸ©é˜µè¿˜æ˜¯å®¹æ˜“çš„</p><p>$$
V(\zeta_n) V(\zeta_n^{-1}) = (n[i = j]) = n I_n
$$</p><p>å³ IDFT æ‰€å¯¹åº”çš„çŸ©é˜µä¸º $V^{-1}(\zeta_n) = \frac{1}{n} V(\zeta_n^{-1})$ï¼Œæˆ‘ä»¬ä¾¿è¯æ˜äº† $(1)$ å¼ã€‚</p><h3 id=é¢„å¤„ç†å•ä½æ ¹>é¢„å¤„ç†å•ä½æ ¹</h3><p>æ¯æ¬¡è®¡ç®—éƒ½é‡æ–°è®¡ç®—ä¸€éå•ä½æ ¹å¤ªæµªè´¹äº†ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å¤„ç†å®ƒï¼Œä»è€Œåœ¨è®¡ç®—ä¸­è°ƒç”¨ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>img</span><span class=o>&gt;</span> <span class=n>ROOT</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=kt>int</span> <span class=n>lim</span> <span class=o>=</span> <span class=p>(</span><span class=n>ROOT</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>}},</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>lim</span> <span class=o>&gt;=</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ROOT</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>lim</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>l</span> <span class=o>*=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span> <span class=o>/</span> <span class=mi>2</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=n>ROOT</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>ROOT</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>ROOT</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>lim</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=tags-å¤šé¡¹å¼>author: &ldquo;rogeryoungh&rdquo;
title: &ldquo;FFT & NTT å­¦ä¹ ç¬”è®°&rdquo;
date: &ldquo;2021-07-22&rdquo;
description: &ldquo;FFT æ€ä¹ˆè¿™ä¹ˆéš¾å•Šã€‚&rdquo;
tags: [å¤šé¡¹å¼]</h2><p>ä»¥ä¸‹æ˜¯æˆ‘å¯¹ FFT çš„æ„Ÿæ€§ç†è§£ï¼Œå¯èƒ½å¹¶ä¸ä¸¥è°¨ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ã€‚</p><h2 id=fft-1>FFT</h2><p>ä»¥ä¸‹è®²è¿°çš„ç®—æ³•æ˜¯ Cooleyâ€“Tukey FFTï¼Œå®ƒåœ¨ç®—æ³•ç«èµ›ä¸­ä½¿ç”¨çš„æ›´ä¸ºå¹¿æ³›ã€‚</p><p>å‰ç½®çŸ¥è¯†ï¼šå¤æ•°ï¼Œéœ€è¦ç†è§£ Euler å…¬å¼ã€‚</p><h3 id=å¤šé¡¹å¼ä¹˜æ³•-1>å¤šé¡¹å¼ä¹˜æ³•</h3><p>å¯¹äº $n$ æ¬¡å¤šé¡¹å¼</p><p>$$
\begin{aligned}
f(x) = \sum_{i=0}^n f_ix^i &= f_0 + f_1 x + f_2x^2 + \cdots + g_nx^n \
g(x) = \sum_{i=0}^n g_ix^i &= g_0 + g_1 x + g_2x^2 + \cdots + g_nx^n
\end{aligned}
$$</p><p>å®ƒä»¬çš„å·ç§¯æ˜¯ $F(x) = f(x) \ast g(x) = (f \ast g)(x) = \sum\limits_{k=0}^{2n} c_kx^k$ï¼Œå…¶ä¸­</p><p>$$
c_k = \sum_{i+j=k}f_ig_j
$$</p><p>å› æ­¤æœ´ç´ çš„è®¡ç®—å¤šé¡¹å¼çš„å·ç§¯éœ€è¦ $n^2$ æ¬¡ç³»æ•°ä¹˜æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚</p><h3 id=ç‚¹å€¼è¡¨ç¤ºæ³•>ç‚¹å€¼è¡¨ç¤ºæ³•</h3><p>$n$ æ¬¡å¤šé¡¹å¼ $f(x)$ å¯ä»¥ç”± $n+1$ ä¸ªç³»æ•°å†³å®šï¼Œä¹Ÿå¯ä»¥ç”± $n+1$ ä¸ªåº§æ ‡ï¼ˆç‚¹å€¼ï¼‰å†³å®šã€‚å³ $n$ æ¬¡å¤šé¡¹å¼å¯ä»¥çœ‹ä½œ $n+1$ ç»´çš„å‘é‡ã€‚</p><p>è€ƒè™‘é€‰å– $2n+1$ ä¸ªåº§æ ‡æ¥ç¡®å®š $f(x)$ å’Œ $g(x)$ã€‚åˆ™ $F(x)$ å¯ä»¥ç®€å•çš„é€šè¿‡åš $2n+1$ æ¬¡ä¹˜æ³•å¾—åˆ°</p><p>$$
(x_k,F(x_k)) = \left(x_k, f(x_k)g(x_k)\right)
$$</p><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æ–°çš„æ€è·¯ï¼šå…ˆä»ç³»æ•°è¡¨ç¤ºæ³•è½¬æ¢ä¸ºç‚¹å€¼è¡¨ç¤ºæ³•ï¼Œåšå®Œä¹˜æ³•åå†å˜å›å»ã€‚</p><h3 id=dft>DFT</h3><p>æ€ä¹ˆæŠŠå¤šé¡¹å¼è½¬æ¢æˆç‚¹å€¼å‘¢ï¼Ÿæˆ‘ä»¬æœ‰ç¦»æ•£ Fourier å˜æ¢ã€‚</p><p>ç§°æ–¹ç¨‹ $x^n = 1$ çš„ $n$ ä¸ªè§£ä¸ºå•ä½æ ¹ $\zeta_n$ã€‚å¯¹äºç»™å®šçš„å¤šé¡¹å¼ $f(x) = \sum\limits_{k=0}^{n-1} f_kx^k$ å’Œä¸€ä¸ªå•ä½æ ¹ $\zeta_n$ï¼Œç§°å‘é‡</p><p>$$
\operatorname{DFT}_{\zeta_n}(f) =( f(1), f(\zeta_n^1), \cdots, f(\zeta_n^{n-1}) )
$$</p><p>ä¸º $f$ çš„ç¦»æ•£ Fourier å˜æ¢ï¼ˆDiscrete Fourier Transformï¼‰ã€‚</p><p>DFT å­˜åœ¨é€†å˜æ¢ï¼ˆIDFTï¼‰ï¼Œå³ä»ç‚¹å€¼é‡æ–°å˜å›ç³»æ•°ï¼Œä»æ˜¯ä»å‘é‡åˆ°å‘é‡çš„å˜æ¢ã€‚</p><p>IDFT å…·æœ‰ä¸€ä¸ªå…³é”®æ€§è´¨</p><p>$$
(\operatorname{DFT}<em>{\zeta})^{-1} = \frac{1}{n} (\operatorname{DFT}</em>{{\zeta}^{-1}}) \tag{1}
$$</p><p>æˆ‘ä»¬å°†åœ¨åæ–‡è¯æ˜å®ƒã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»Ÿä¸€çš„å¤„ç† DFT å’Œ IDFTã€‚</p><p>ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æŠŠ $\operatorname{DFT}_{\zeta_n}$ ç®€å•çš„è®°ä½œ $\mathcal{F}_n$ã€‚</p><h3 id=å•ä½åŸæ ¹-1>å•ä½åŸæ ¹</h3><p>è‡³æ­¤ï¼Œæˆ‘ä»¬è®¡ç®— DFT çš„å¤æ‚åº¦ä»ç„¶æ˜¯ $O(n^2)$ï¼ŒFFT æ‰€è¿ˆå‡ºçš„å…³é”®ä¸€æ­¥æ˜¯é€‰å–ç‰¹æ®Šçš„ç‚¹åŠ é€Ÿè®¡ç®—ã€‚</p><p>å•ä½æ ¹ä¸­ç‰¹æ®Šçš„ä¸€ä¸ªè®°ä½œ $\zeta_n = e^{\frac{2 \pi i}{n}}$ï¼Œå®ƒå«åšå•ä½åŸæ ¹ã€‚ä¾ Euler å…¬å¼ï¼Œæœ‰</p><p>$$
\zeta_n = e^{\tfrac{2 \pi i}{n}} = \cos \left(\frac{2\pi}{n}\right) + i \sin \left(\frac{2\pi}{n}\right)
$$</p><p>å³ $\zeta_n$ æ˜¯å•ä½åœ†ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œå…¨éƒ¨çš„ $n$ ä¸ªå•ä½æ ¹</p><p>$$
x_k = \zeta_n^k = e^{k\tfrac{2 \pi i}{n}} = \cos \left(\frac{2\pi k}{n}\right) + i \sin \left(\frac{2\pi k}{n}\right)
$$</p><p>æ°å¯¹åº”åˆ°å•ä½åœ†çš„ $n$ ç­‰åˆ†ç‚¹ã€‚å› æ­¤æ ¹æ® Euler å…¬å¼ï¼Œ<strong>å•ä½æ ¹ä¹‹é—´çš„ä¹˜æ³•å°±æ˜¯åœ¨å•ä½åœ†ä¸Šè½¬åœˆåœˆã€‚</strong></p><p>ä¸éš¾é€šè¿‡ Euler å…¬å¼éªŒè¯å•ä½åŸæ ¹ $\zeta_n$ çš„å‡ æ¡æ€§è´¨ï¼š</p><ul><li>$\zeta_{2n}^{2k} = \zeta_n^k$ã€‚</li><li>$\zeta_{2n}^{n+k} = -\zeta_{2n}^k$ã€‚</li></ul><h3 id=åˆ†æ²»-1>åˆ†æ²»</h3><p>åˆ©ç”¨å•ä½åŸæ ¹çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æ²»è®¡ç®— DFTã€‚æ¯”å¦‚å¯¹äº $7$ æ¬¡å¤šé¡¹å¼</p><p>$$
\begin{aligned}
f(x) &= f_0 + f_1x + f_2x^2 + f_3 x^3 + f_4 x^4 + f_5 x^5 + f_6 x^6 + f_7 x^7 \
&= (f_0 + f_2x^2 + f_4x^4 + f_6x^6) + x(f_1 + f_3x^2 + f_5x^4 + f_7x^6)
\end{aligned}
$$</p><p>å¥‡å¶åˆ†ç±»</p><p>$$
\begin{aligned}
f^{[0]}(x) &= f_0 + f_2x + f_4x^2 + f_6x^3 \
f^{[1]}(x) &= f_1 + f_3x + f_5x^2 + f_7x^3
\end{aligned}
$$</p><p>åˆ™åŸæ¥çš„å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸º</p><p>$$
f(x) = f^{[0]}(x^2) + xf^{[1]}(x^2)
$$</p><p>ä¸€èˆ¬çš„ï¼Œå¯¹äºåº¦å°äº $n$ çš„å¤šé¡¹å¼ $f(x)$ï¼Œåœ¨å•ä½æ ¹ $x = \zeta_n^k$ å¤„çš„ç‚¹å€¼æ˜¯</p><p>$$
\begin{aligned}
f(\zeta_n^k) &= f^{[0]}(\zeta_n^k \cdot \zeta_n^k) + \zeta_n^kf^{[1]}(\zeta_n^k \cdot \zeta_n^k) \
&= f^{[0]}(\zeta_n^{2k}) + \zeta_n^kf^{[1]}(\zeta_n^{2k}) \
&= f^{[0]}(\zeta_{n/2}^{k}) + \zeta_n^kf^{[1]}(\zeta_{n/2}^{k})
\end{aligned}
$$</p><p>åŒç†å¯å¾—</p><p>$$
\begin{aligned}
f(\zeta_n^{k+n/2}) &= f^{[0]}(\zeta_n^{2k+n}) + \zeta_n^{k+n/2}f^{[1]}(\zeta_n^{2k+n}) \
&= f^{[0]}(\zeta_{n/2}^{k}) - \zeta_n^{k}f^{[1]}(\zeta_{n/2}^{k})
\end{aligned}
$$</p><p>åœ¨ DFT ä¸­ä½¿ç”¨æœ‰</p><p>$$
\begin{aligned}
\mathcal{F}<em>n(f)[j] &= \mathcal{F}</em>{n/2}(f^{[0]})[j] + \zeta_n^j \mathcal{F}<em>{n/2}(f^{[1]})[j] \
\mathcal{F}<em>n(f)[j + n/2] &= \mathcal{F}</em>{n/2}(f^{[0]})[j] - \zeta_n^j\mathcal{F}</em>{n/2}(f^{[1]})[j]
\end{aligned}
\tag{2}
$$</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦æŠŠå¤šé¡¹å¼çš„ç³»æ•°ä¸ªæ•°å‘ä¸Šè¡¥åˆ° $2^n$ï¼Œæ–¹ä¾¿åˆ†æ²»ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºé€’å½’ç‰ˆçš„ FFTã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>op</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>img</span> <span class=n>tmp</span><span class=p>[</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>18</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>  <span class=c1>// å¶æ•°æ”¾å·¦è¾¹ï¼Œå¥‡æ•°æ”¾å³è¾¹
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>i</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>*</span><span class=n>g</span> <span class=o>=</span> <span class=n>f</span><span class=p>,</span> <span class=o>*</span><span class=n>h</span> <span class=o>=</span> <span class=n>f</span> <span class=o>+</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fft</span><span class=p>(</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>op</span><span class=p>),</span> <span class=n>fft</span><span class=p>(</span><span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>,</span> <span class=n>h</span><span class=p>,</span> <span class=n>op</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>PI</span> <span class=o>/</span> <span class=n>n</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>PI</span> <span class=o>*</span> <span class=n>op</span> <span class=o>/</span> <span class=n>n</span><span class=p>)},</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>+</span> <span class=n>w</span> <span class=o>*</span> <span class=n>h</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=n>w</span> <span class=o>*</span> <span class=n>h</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è´è¶å˜æ¢-1>è´è¶å˜æ¢</h3><p>é€’å½’åˆ†æ²»æ€»æ˜¯ä¸å°½äººæ„çš„ï¼Œæˆ‘ä»¬åœ¨å‰å‡ è¡Œåªæ˜¯åšäº†é€’å½’åˆ†ç»„çš„äº‹æƒ…ï¼Œå¯ä»¥è€ƒè™‘ä¸€æ­¥åˆ°ä½ã€‚</p><p>è¿˜æ˜¯ä»¥ $7$ æ¬¡å¤šé¡¹å¼ä¸ºä¾‹</p><ul><li>åˆå§‹ ${x^0,x^1,x^2,x^3,x^4,x^5,x^6,x^7}$</li><li>ä¸€æ¬¡ ${x^0,x^2,x^4,x^6},{x^1,x^3,x^5,x^7}$</li><li>ä¸¤æ¬¡ ${x^0,x^4},{x^2,x^6},{x^1,x^5},{x^3,x^7}$</li><li>ç»“æŸ ${x^0},{x^4},{x^2},{x^6},{x^1},{x^5},{x^3},{x^7}$</li></ul><p>å†™å‡ºäºŒè¿›åˆ¶çš„å½¢å¼ï¼Œå¯ä»¥å‘ç°ï¼šç»“æŸå’Œå¼€å§‹çš„äºŒè¿›åˆ¶æ°å¥½æ˜¯ç›¸åçš„ã€‚</p><div class=table-wrapper><table><thead><tr><th style=text-align:center>åˆå§‹</th><th style=text-align:center>0</th><th style=text-align:center>1</th><th style=text-align:center>2</th><th style=text-align:center>3</th><th style=text-align:center>4</th><th style=text-align:center>5</th><th style=text-align:center>6</th><th style=text-align:center>7</th></tr></thead><tbody><tr><td style=text-align:center>åˆå§‹(2)</td><td style=text-align:center>000</td><td style=text-align:center>001</td><td style=text-align:center>010</td><td style=text-align:center>011</td><td style=text-align:center>100</td><td style=text-align:center>101</td><td style=text-align:center>110</td><td style=text-align:center>111</td></tr><tr><td style=text-align:center>ç»“æŸ(2)</td><td style=text-align:center>000</td><td style=text-align:center>100</td><td style=text-align:center>010</td><td style=text-align:center>110</td><td style=text-align:center>001</td><td style=text-align:center>101</td><td style=text-align:center>011</td><td style=text-align:center>111</td></tr><tr><td style=text-align:center>ç»“æŸ</td><td style=text-align:center>0</td><td style=text-align:center>4</td><td style=text-align:center>2</td><td style=text-align:center>6</td><td style=text-align:center>1</td><td style=text-align:center>5</td><td style=text-align:center>3</td><td style=text-align:center>7</td></tr></tbody></table></div><p>è¿™ä¸ªå˜æ¢ç§°ä¸ºè´è¶å˜æ¢ï¼Œä¹Ÿç§°ä½é€†åºç½®æ¢ï¼ˆbit-reversal permutationï¼‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ $O(n)$ çš„é¢„å¤„ç†å‡ºå˜æ¢æ•°ç»„ã€‚è®¾ <code>R(x)</code> æ˜¯ $x$ çš„å˜æ¢ç»“æœï¼Œåˆ™ <code>R(x >> 1)</code> æ­¤æ—¶æ˜¯å·²çŸ¥çš„ã€‚å³æ˜¯æŠŠ <code>R(x >> 1)</code> å³ç§»ä¸€ä½å†è¡¥ä¸Šæœ€é«˜ä½å³å¯ã€‚ä»£ç å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>pre_rev</span><span class=p>(</span><span class=kt>int</span> <span class=n>lim</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>__lg</span><span class=p>(</span><span class=n>lim</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>rev</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>lim</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>lim</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>]</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>|=</span> <span class=n>lim</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æˆ–è€…åˆå¹¶å†™ä¸º
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (k - 1));
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™å‡ºéé€’å½’ç‰ˆçš„ FFTã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>op</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// DIT
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;=</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>*</span> <span class=n>op</span> <span class=o>/</span> <span class=n>l</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>l</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span> <span class=n>x</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>y</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ntt-1>NTT</h2><p>å‰ç½®çŸ¥è¯†ï¼šæ•°è®ºåŸºç¡€ï¼ˆæ•´é™¤ï¼ŒåŒä½™ï¼‰ã€‚</p><p>ç”¨ <code>double</code> å»å®ç°æ•´æ•°çš„ä¹˜æ³•æ˜¯å¾ˆä¸ä¼˜ç¾çš„ï¼Œç²¾åº¦ã€é€Ÿåº¦éƒ½å¾ˆæˆé—®é¢˜ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä»…åœ¨æ•´æ•°ä¸‹è¿›è¡Œè¿ç®—ã€‚</p><h3 id=åŸæ ¹-1>åŸæ ¹</h3><p>æˆ‘ä»¬æœ¬è´¨ä¸Šç”¨åˆ°çš„å•ä½åŸæ ¹ $\zeta_n$ çš„ä¸¤ä¸ªæ€§è´¨æ˜¯ï¼š</p><ul><li>$\zeta_{n}^{n} = 1$ã€‚</li><li>$\zeta_{2n}^{n} = -1$ã€‚</li></ul><p>å¯ä»¥è”æƒ³åˆ°æ¨¡ $p$ å‰©ä½™ç±»åŸŸ $\mathbb{Z}_p$ï¼šå…¶ä¸­çš„å…ƒç´ æ˜¯ ${0,1,\cdots,p-1}$ï¼Œå…¶ä¸Šçš„è¿ç®—éƒ½æ˜¯æ¨¡ $p$ çš„ã€‚ç”±äº Fermat å°å®šç†</p><p>$$
a^{\varphi(p)} = a^{p-1} \equiv 1
$$</p><p>å³ä»å¦ä¸€ä¸ªè§’åº¦è¯´ï¼Œ$p-1$ ä¸ªæ­£æ•´æ•°éƒ½æ˜¯åŒä½™æ–¹ç¨‹ $x^{p-1} \equiv 1$ çš„è§£ã€‚</p><p>å®ƒå’Œå•ä½æ ¹æœ‰å¾ˆç›¸ä¼¼çš„å½¢å¼ï¼Œç›´è§‰ä¸Š $\mathbb{Z}_p$ ä¹Ÿå­˜åœ¨ç±»ä¼¼å•ä½åŸæ ¹çš„ç‰¹æ®Šæ•°å­—ã€‚ä¸‹é¢æˆ‘ä»¬åœ¨ $\mathbb{Z}_p$ ä¸Šè®¨è®ºï¼Œå°è¯•è¯æ˜è¿™ä¸ªæ•°å­—å­˜åœ¨ã€‚</p><p>å®šä¹‰æ­£æ•´æ•° $a \in \mathbb{Z}_p$ çš„é˜¶ $\delta_p(a)$ ä¸ºæœ€å°çš„ $r$ ä½¿å¾— $a^r \equiv 1$ã€‚ç”± Fermat å°å®šç† $a^{\varphi(p)} \equiv 1$ï¼Œå› æ­¤ $a$ çš„é˜¶ä¸€å®šå­˜åœ¨ä¸”æœ‰ $\delta_p(a) \mid \varphi(p)$ã€‚å¯ä»¥è¯æ˜</p><p>$$
a,a^2,\cdots a^{\delta_p(a)} \tag{3}
$$</p><p>åœ¨æ¨¡ $p$ ä¸‹ä½™æ•°äº’ä¸ç›¸åŒã€‚ç”± Lagrange å®šç†ï¼Œ$x^{\delta_p(a)} \equiv 1$ çš„è§£è‡³å¤šæœ‰ $\delta_p(a)$ ä¸ªï¼Œæ°æ˜¯ $(3)$ ä¸­æ‰€å±•ç¤ºçš„ã€‚</p><p>é€šè¿‡æ•´é™¤çš„æ€§è´¨ï¼Œå¯ä»¥æƒ³åˆ°åªæœ‰ $i \bot \delta_p(a)$ æ‰æœ‰ $\delta_p(a^i) = \delta_p(a)$ï¼Œå³ $a$ æ€»æ˜¯é™„å¸¦ç€</p><p>$$
\sum_{i=1}^{\delta_p(a)} [\gcd(i, \delta_p(a)) = 1] = \varphi(\delta_p(a))
$$</p><p>ä¸ªé˜¶ç›¸åŒçš„ä¸œè¥¿ã€‚å› æ­¤é˜¶ä¸º $\delta_p(a)$ çš„æ•°æ°æœ‰ $\varphi(\delta_p(a))$ ä¸ªã€‚</p><p>å› ä¸ºæ¯ä¸ªæ­£æ•´æ•°éƒ½æœ‰å”¯ä¸€ç¡®å®šçš„é˜¶ï¼Œä¸å¦¨å‡è®¾å¯¹äºæ‰€æœ‰ $d \mid \varphi(p)$ï¼Œé˜¶ $d$ éƒ½å­˜åœ¨ $\varphi(d)$ ä¸ªå¯¹åº”çš„æ•´æ•°ï¼Œç»Ÿè®¡æ•´æ•°ä¸ªæ•°</p><p>$$
\sum_{d \mid \varphi(p)} \varphi(d) = \varphi(p) = p - 1
$$</p><p>æ°ä¸º $\mathbb{Z}_p$ å…¨éƒ¨æ­£æ•´æ•°çš„ä¸ªæ•°ï¼Œå› æ­¤å‡è®¾æˆç«‹ï¼Œä¹Ÿå°±å­˜åœ¨ $a$ ä½¿å¾— $\delta_p(a) = p-1$ã€‚</p><p>æˆ‘ä»¬ç§°è¿™ä¸ª $a$ æ˜¯æ¨¡ $p$ ä¸‹çš„ä¸€ä¸ªåŸæ ¹ï¼Œå¸¸ç”¨å­—æ¯ $g$ è¡¨ç¤ºã€‚</p><h3 id=å¿«é€Ÿæ•°è®ºå˜æ¢-1>å¿«é€Ÿæ•°è®ºå˜æ¢</h3><p>å°½å¯èƒ½æå– $p - 1$ çš„å› å­ $2$ æœ‰</p><p>$$
p = N q + 1, N = 2^m
$$</p><p>è®¾ $\mathbb{Z}_p$ çš„ä¸€ä¸ªåŸæ ¹ $g$ï¼Œå°† $g_N \equiv g^q$ çœ‹ä½œ $\zeta_n$ çš„ç­‰ä»·ã€‚åˆ©ç”¨äºŒæ¬¡å‰©ä½™çš„çŸ¥è¯†ä¸éš¾å¾—åˆ° $g_N^N \equiv 1$ å’Œ $g_N^{N/2} \equiv -1$ã€‚</p><p>å¸¸è§çš„æœ‰</p><p>$$
\begin{aligned}
p = 1004535809 = 479 \times 2^{21} + 1&, g = 3 \
p = 998244353 = 7 \times 17 \times 2^{23} + 1&, g = 3
\end{aligned}
$$</p><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºç¨‹åº</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>ntt</span><span class=p>(</span><span class=n>ll</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>h</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span> <span class=n>h</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>h</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ll</span> <span class=n>tg</span> <span class=o>=</span> <span class=n>type</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=mi>3</span> <span class=o>:</span> <span class=n>g_inv</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>ll</span> <span class=n>gn</span> <span class=o>=</span> <span class=n>qpow</span><span class=p>(</span><span class=n>tg</span><span class=p>,</span> <span class=p>(</span><span class=n>P</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=n>h</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span> <span class=o>+=</span> <span class=n>h</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>ll</span> <span class=n>g</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>j</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>j</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ll</span> <span class=n>f1</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>],</span> <span class=n>f2</span> <span class=o>=</span> <span class=n>g</span> <span class=o>*</span> <span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>f1</span> <span class=o>+</span> <span class=n>f2</span><span class=p>)</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>k</span> <span class=o>+</span> <span class=n>h</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>f1</span> <span class=o>-</span> <span class=n>f2</span> <span class=o>+</span> <span class=n>P</span><span class=p>)</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>g</span> <span class=o>=</span> <span class=n>g</span> <span class=o>*</span> <span class=n>gn</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>iv_n</span> <span class=o>=</span> <span class=n>qpow</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>iv_n</span> <span class=o>%</span> <span class=n>P</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è‡³æ­¤ï¼Œä½ å·²ç»å­¦ä¼š FFT äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°†æ›´æ·±å…¥çš„ä»æ•°å­¦è§’åº¦ç ”ç©¶ FFTï¼Œè¡¥è¶³ç†è®ºåŸºç¡€ã€‚</p><h2 id=çº¿æ€§å˜æ¢-1>çº¿æ€§å˜æ¢</h2><p>DFT æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥è¢«å†™æˆçŸ©é˜µä¹˜æ³•çš„å½¢å¼</p><p>$$
\begin{bmatrix}
f(\zeta_n^0) \ f(\zeta_n^1) \ f(\zeta_n^2) \ \vdots \ f(\zeta_n^{n-1})
\end{bmatrix} = \begin{bmatrix}
1 & 1 & 1 & \cdots & 1 \
1 & \zeta_n^1 & \zeta_n^2 & \cdots & \zeta_n^{n-1} \
1 & \zeta_n^2 & \zeta_n^4 & \cdots & \zeta_n^{2(n-1)} \
\vdots & \vdots & \vdots & \ddots & \vdots \
1 & \zeta_n^{n-1} & \zeta_n^{2(n-1)} & \cdots & \zeta_n^{(n-1)^2}
\end{bmatrix}
\begin{bmatrix}
f_0 \ f_1 \ f_2 \ \vdots \ f_{n-1}
\end{bmatrix}
$$</p><p>æˆ‘ä»¬æŠŠä¸­é—´çš„é‚£ä¸ª $n$ é˜¶çš„ Vandermonde æ–¹é˜µè®°ä¸º $V(\zeta_n) = (\zeta_n^{ij})$ã€‚</p><p>ç›´æ¥è®¡ç®— $V(\zeta_n)$ çš„é€†å¾ˆä¸å¥½ç®—ï¼Œä½†æ˜¯éªŒè¯ä¸‹å¼æ˜¯å¯¹è§’çŸ©é˜µè¿˜æ˜¯å®¹æ˜“çš„</p><p>$$
V(\zeta_n) V(\zeta_n^{-1}) = (n[i = j]) = n I_n
$$</p><p>å³ IDFT æ‰€å¯¹åº”çš„çŸ©é˜µä¸º $V^{-1}(\zeta_n) = \frac{1}{n} V(\zeta_n^{-1})$ï¼Œæˆ‘ä»¬ä¾¿è¯æ˜äº† $(1)$ å¼ã€‚</p><h3 id=å¹²æ‰-rev>å¹²æ‰ REV</h3><p>å…¶å®ä¸Šæ–‡æ‰€å®ç°çš„ FFT å’Œ IFFT å¹¶ä¸å¯¹å¶ï¼Œåªæ˜¯å·ç§¯å®šç†ä½¿å¾— IFFT æ°æ˜¯ FFT çš„é€†è¿ç®—ã€‚å…·ä½“çš„è¯´ï¼Œæˆ‘ä»¬å®ç°äº†ä¸¤ä¸ª DITï¼Œå› æ­¤éœ€è¦åœ¨è®¡ç®—ä¹‹å‰è¿›è¡Œè´è¶å˜æ¢ã€‚</p><p><img src=https://upload.wikimedia.org/wikipedia/commons/f/f2/DIF_DIT.jpg loading=lazy alt=Wikipedia></p><p>æˆ‘ä»¬è¿ç®—çš„æ ¸å¿ƒå†…å®¹åœ¨äº $(2)$ å¼ï¼Œå®ƒå¯ä»¥è¢«å†™åšçŸ©é˜µå½¢å¼ã€‚</p><p>$$
\begin{bmatrix}
O_1 \ O_2
\end{bmatrix} =
\begin{bmatrix}
1 & \zeta_n^{-j} \
1 & -\zeta_n^{-j}
\end{bmatrix}
\begin{bmatrix}
I_1 \ I_2
\end{bmatrix}
$$</p><p>å¯¹çŸ©é˜µæ±‚é€†</p><p>$$
\begin{bmatrix}
I_1 \ I_2
\end{bmatrix} = \frac{1}{2}
\begin{bmatrix}
1 & 1 \
\zeta_n^{j} & -\zeta_n^{j}
\end{bmatrix}
\begin{bmatrix}
O_1 \ O_2
\end{bmatrix} \tag{4}
$$</p><p>æˆ‘ä»¬ä¾¿å¾—åˆ°äº† DIFã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸¤ä¸ª DIF ä½œä¸º FFTï¼Œæ­¤æ—¶è´è¶å˜æ¢åœ¨è®¡ç®—ä¹‹åã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>op</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// DIF
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>l</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>l</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>*</span> <span class=n>op</span> <span class=o>/</span> <span class=n>l</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>l</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span> <span class=n>x</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>y</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>&lt;</span> <span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>f</span><span class=p>[</span><span class=n>rev</span><span class=p>[</span><span class=n>i</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>op</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å®¹æ˜“å‘ç°ï¼Œè‹¥æˆ‘ä»¬ä»¥ DIF ä½œä¸º FFTï¼ŒDIT ä½œä¸º IFFTï¼Œæ˜¯ä¸éœ€è¦è´è¶å˜æ¢çš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>void</span> <span class=nf>fft</span><span class=p>(</span><span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>l</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>l</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>l</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span> <span class=n>x</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>y</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>ifft</span><span class=p>(</span><span class=n>img</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;=</span> <span class=n>n</span> <span class=o>/</span> <span class=mi>2</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w0</span> <span class=o>=</span> <span class=n>img</span><span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span><span class=p>)}.</span><span class=n>conj</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>l</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>img</span> <span class=n>x</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>],</span> <span class=n>y</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>w</span> <span class=o>=</span> <span class=n>w</span> <span class=o>*</span> <span class=n>w0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>/</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»¥ä¸Šï¼Œä¾¿æ˜¯ Twisted FFTã€‚</p><h3 id=å¦ä¸€ç§ç†è§£>å¦ä¸€ç§ç†è§£</h3><p>æ³¨æ„åˆ°</p><p>$$
f(x_0) = f \bmod (x - x_0)
$$</p><p>æˆ‘ä»¬å¯ä»¥ä»è¿™æ–¹é¢ç€æ‰‹ï¼Œä»å–æ¨¡è§’åº¦é‡æ–°å®¡è§†ä¸Šè¿°ç®—æ³•ã€‚å‡è®¾ $f$ å¯ä»¥è¢«åˆ†è§£ä¸º</p><p>$$
f = (x^n - r)(x^n + r)f_{0} + (x^n - r)f_{1} + (x^n + r)f_{2} + f_3
$$</p><p>ä»¤</p><p>$$
\begin{aligned}
O_1 &= f \bmod (x^n + r) = -2r f_1 + f_3\
O_2 &= f \bmod (x^n - r) = 2r f_2 + f_3
\end{aligned}
$$</p><p>æ•…</p><p>$$
f \bmod (x^{2n} - r^2) = \frac{O_2-O_1}{2r}x^n + \frac{O_2 + O_1}{2} = I_1 x^n + I_2
$$</p><p>æ³¨æ„åˆ°ä»£ç ä¸­æˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥æ±‚ $O_1$ï¼Œè€Œæ˜¯å¯¹ç¬¬ $j$ ä½ä¹˜ä¸Šäº† $\zeta_{2n}^j$ï¼Œå³æ±‚çš„æ˜¯ $f(\zeta_{2n}x)$ã€‚</p><p>å¯ä»¥å‘ç°</p><p>$$
f(\zeta_{2n}x) \bmod (x^n-1) = f(\zeta_{2n}x) \bmod ((\zeta_{2n} x)^n - 1) = f(x) \bmod (x^n + 1)
$$</p><p>è¿™ä¸ªå›¾å¹¶ä¸å¥½ç†è§£ï¼Œä¸‹é¢é‚£å¼  Original FFT æ›´å®¹æ˜“ç†è§£ï¼Œä½†æ˜¯ç°åœ¨å¹¿ä¸ºæµä¼ çš„ç®—æ³•æ˜¯ Twisted FFTã€‚</p><p>é€šè¿‡å›¾å¯ä»¥çœ‹å‡ºï¼ŒFFT çš„è¿‡ç¨‹å³æ˜¯å…ˆæŠŠå¤šé¡¹å¼ä»æ ¹æ¨åˆ°å¶å­ï¼Œå³æ±‚å¾—æ‰€æœ‰å•ä½æ ¹å¤„çš„å€¼ï¼Œåšå®Œæ“ä½œåï¼Œå†ä»å¶å­æ¨å›æ ¹ã€‚</p><h3 id=original-fft>Original FFT</h3><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ†æ²»ï¼Œä¾¿æ˜¯ Original FFTã€‚</p><p>ç”±äºç¯‡å¹…æœ‰é™ï¼Œæœ¬æ–‡ä¸å±•å¼€ã€‚</p><h3 id=é¢„å¤„ç†å•ä½æ ¹-1>é¢„å¤„ç†å•ä½æ ¹</h3><p>æ¯æ¬¡è®¡ç®—éƒ½é‡æ–°è®¡ç®—ä¸€éå•ä½æ ¹å¤ªæµªè´¹äº†ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å¤„ç†å®ƒï¼Œä»è€Œåœ¨è®¡ç®—ä¸­è°ƒç”¨ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>img</span><span class=o>&gt;</span> <span class=n>ROOT</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>init</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=kt>int</span> <span class=n>lim</span> <span class=o>=</span> <span class=p>(</span><span class=n>ROOT</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>}},</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>lim</span> <span class=o>&gt;=</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ROOT</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=n>lim</span><span class=p>;</span> <span class=n>l</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>l</span> <span class=o>*=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=n>w</span> <span class=o>=</span> <span class=p>{</span><span class=n>cos</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span> <span class=o>/</span> <span class=mi>2</span><span class=p>),</span> <span class=n>sin</span><span class=p>(</span><span class=n>PI</span> <span class=o>/</span> <span class=n>l</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>        <span class=n>ROOT</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>l</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>ROOT</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>ROOT</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=n>w</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>lim</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å…¶ä»–åº”ç”¨>å…¶ä»–åº”ç”¨</h3><p>FFT å®é™…ä¸Šæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—å·ç§¯ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘æƒ³æ›´èšç„¦äºç†è§£ FFT çš„è®¡ç®—è¿‡ç¨‹ã€‚</p><p>FFT è¿˜æœ‰å¾ˆå¤šåº”ç”¨ï¼Œæ¯”å¦‚å¿«é€ŸåŠ æ³•ï¼Œå¸¦é€šé…æ–‡æœ¬åŒ¹é…ç­‰ï¼Œåé¢ç­‰å†åˆ·äº›é¢˜äº†å¯èƒ½ä¼šå¼€ä¸€ç¯‡è®²ä¸€è®²è¿™ä¸ªï¼Œç°åœ¨æˆ‘ç§¯ç´¯çš„è¿˜ä¸å¤Ÿã€‚</p><h2 id=refence>Refence</h2><ol><li><a class=link href=https://oi-wiki.org/math/poly/fft/ target=_blank rel=noopener>OI-Wiki å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</a></li><li><a class=link href=https://loj.ac/d/3165 target=_blank rel=noopener>FFT å…¥é—¨ç¬”è®° - hly1024</a></li></ol></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E6%95%B0%E8%AE%BA%E5%88%86%E5%9D%97/><div class=article-details><h2 class=article-title>æ•°è®ºåˆ†å—</h2></div></a></article><article><a href=/p/gcd-exgcd/><div class=article-details><h2 class=article-title>GCD & EXGCD</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 sy</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>